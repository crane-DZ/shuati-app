<!DOCTYPE html>
<html>
<head>
    <title>智能刷题系统</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div id="quiz">
        <h1 id="question"></h1>
        <div id="options"></div>
        <button onclick="submitAnswer()">提交答案</button>
    </div>

    <script>
        let currentQuestion = null;
        let selectedAnswers = [];

        function loadQuestion() {
            $.getJSON('/api/questions/random/1', (data) => {
                currentQuestion = data[0];
                $('#question').text(currentQuestion.content);
                
                const optionsHtml = currentQuestion.options.map((opt, index) => 
                    `<div onclick="selectOption(${index})">
                        ${String.fromCharCode(65 + index)}. ${opt}
                    </div>`
                ).join('');
                $('#options').html(optionsHtml);
            });
        }

        function selectOption(index) {
            if (currentQuestion.type === 'multiple') {
                selectedAnswers = selectedAnswers.includes(index) 
                    ? selectedAnswers.filter(i => i !== index) 
                    : [...selectedAnswers, index];
            } else {
                selectedAnswers = [index];
            }
        }

        function submitAnswer() {
            $.ajax({
                url: '/api/answers',
                method: 'POST',
                data: JSON.stringify({
                    user_id: 'user123',
                    question_id: currentQuestion.id,
                    answer: selectedAnswers
                }),
                contentType: 'application/json',
                success: () => alert('答案已保存！')
            });
        }

        loadQuestion();
    </script>
</body>
</html>
